#Проект: Предсказание стоимости жилья

### **Цель работы**

Целью проекта является построение моделей машинного обучения в среде **Apache Spark** для предсказания медианной стоимости жилья в Калифорнии на данных переписи 1990 года. Используется библиотека **Spark MLlib**, которая позволяет обрабатывать данные распределённо и строить ML-пайплайны.

---

### **Этапы работы**

1. **Подготовка данных**

   * Загрузка датасета `housing.csv` с помощью `spark.read.csv()`.
   * Определение типов данных: числовые признаки как `double`, категориальный `ocean_proximity` как `string`.
   * Анализ пропусков: выявлено 207 пропусков в `total_bedrooms`.
   * Пропуски заполнены средним значением через `Imputer`.

2. **Формирование выборок**

   * Разделение датасета на обучающую и тестовую выборки (80/20).
   * Все трансформации (импьютация, кодирование категориальных признаков) обучаются только на train.

3. **Предобработка признаков**

   * Числовые признаки объединены через `VectorAssembler`.
   * Категориальный признак `ocean_proximity` преобразован через `StringIndexer` → `OneHotEncoder`.
   * Все признаки собраны в общий вектор `features`.

4. **Моделирование**

   * Построены две модели линейной регрессии (ридж-регрессия, `LinearRegression` с `regParam=0.1`, `elasticNetParam=0.0`):

     * **Модель A** — только числовые признаки.
     * **Модель B** — числовые + one-hot кодированный `ocean_proximity`.

5. **Оценка качества**

   * Для оценки использованы метрики:

     * RMSE (среднеквадратичная ошибка),
     * MAE (средняя абсолютная ошибка),
     * R² (коэффициент детерминации).

---

### **Результаты**

* **Модель A — только числовые признаки**

  * RMSE: ≈ 71 783
  * MAE: ≈ 51 788
  * R²: 0.628

* **Модель B — числовые + категориальный признак**

  * RMSE: ≈ 70 781
  * MAE: ≈ 50 855
  * R²: 0.638

---

### **Выводы**

* Добавление категориального признака `ocean_proximity` дало небольшой прирост качества: уменьшились ошибки RMSE/MAE и увеличилось R².
* Средняя абсолютная ошибка (\~50 тыс. долларов) соответствует примерно 10% реального диапазона цен, что является реалистичной точностью для линейной модели.
* Spark-пайплайн позволил выстроить полный цикл: от обработки пропусков и кодирования категориальных признаков до обучения и оценки модели.
